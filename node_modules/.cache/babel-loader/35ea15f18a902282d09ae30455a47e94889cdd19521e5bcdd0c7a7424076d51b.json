{"ast":null,"code":"// src/pages/ListPage.js\nimport React,{useState,useEffect,useContext}from'react';import api from'../services/api';import{AuthContext}from'../context/AuthContext';import{Link}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function ListPage(){const[data,setData]=useState([]);const[filters,setFilters]=useState({keyword:'',startDate:'',endDate:'',category:''});const[categories,setCategories]=useState([]);// Suponiendo que las categorías vienen del backend\nconst{auth,logout}=useContext(AuthContext);useEffect(()=>{fetchData();fetchCategories();// Si las categorías se obtienen del backend\n// eslint-disable-next-line\n},[]);const fetchData=async()=>{try{const response=await api.get('/data');setData(response.data);}catch(err){console.error(err);}};const fetchCategories=async()=>{try{const response=await api.get('/categories');// Ajusta según tu backend\nsetCategories(response.data);}catch(err){console.error(err);}};const handleDelete=async id=>{if(window.confirm('¿Estás seguro de eliminar este registro?')){try{await api.delete(`/data/${id}`);setData(data.filter(item=>item.id!==id));}catch(err){console.error(err);alert('Error al eliminar el registro.');}}};const handleFilterChange=e=>{setFilters({...filters,[e.target.name]:e.target.value});};const applyFilters=()=>{// Implementar lógica para aplicar filtros. Podrías hacer una solicitud al backend con parámetros de consulta.\n// Aquí se muestra una filtración en el frontend como ejemplo.\nlet filtered=[...data];if(filters.keyword){filtered=filtered.filter(item=>item.name.toLowerCase().includes(filters.keyword.toLowerCase()));}if(filters.startDate){filtered=filtered.filter(item=>new Date(item.date)>=new Date(filters.startDate));}if(filters.endDate){filtered=filtered.filter(item=>new Date(item.date)<=new Date(filters.endDate));}if(filters.category){filtered=filtered.filter(item=>item.category===filters.category);}return filtered;};const handleLogout=()=>{logout();window.location.href='/';};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Listado\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Cerrar Sesi\\xF3n\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Filtros\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"keyword\",placeholder:\"Buscar por palabra clave\",value:filters.keyword,onChange:handleFilterChange}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"startDate\",placeholder:\"Fecha de inicio\",value:filters.startDate,onChange:handleFilterChange}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"endDate\",placeholder:\"Fecha de fin\",value:filters.endDate,onChange:handleFilterChange}),/*#__PURE__*/_jsxs(\"select\",{name:\"category\",value:filters.category,onChange:handleFilterChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Todas las categor\\xEDas\"}),categories.map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat.name,children:cat.name},cat.id))]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setFilters({keyword:'',startDate:'',endDate:'',category:''}),children:\"Limpiar Filtros\"})]}),/*#__PURE__*/_jsx(Link,{to:\"/form\",children:\"Crear Nuevo Registro\"}),/*#__PURE__*/_jsx(\"ul\",{children:applyFilters().map(item=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:item.name}),\" - \",item.email,\" - \",item.category,\" - \",item.date,auth.user.role==='admin'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:`/form/${item.id}`,children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(item.id),children:\"Eliminar\"})]})]},item.id))})]});}export default ListPage;","map":{"version":3,"names":["React","useState","useEffect","useContext","api","AuthContext","Link","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ListPage","data","setData","filters","setFilters","keyword","startDate","endDate","category","categories","setCategories","auth","logout","fetchData","fetchCategories","response","get","err","console","error","handleDelete","id","window","confirm","delete","filter","item","alert","handleFilterChange","e","target","name","value","applyFilters","filtered","toLowerCase","includes","Date","date","handleLogout","location","href","children","onClick","type","placeholder","onChange","map","cat","to","email","user","role"],"sources":["C:/Users/casti/OneDrive/Escritorio/frontend_GDocumetnal/src/pages/ListPage.js"],"sourcesContent":["// src/pages/ListPage.js\r\nimport React, { useState, useEffect, useContext } from 'react';\r\nimport api from '../services/api';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { Link } from 'react-router-dom';\r\n\r\nfunction ListPage() {\r\n  const [data, setData] = useState([]);\r\n  const [filters, setFilters] = useState({\r\n    keyword: '',\r\n    startDate: '',\r\n    endDate: '',\r\n    category: '',\r\n  });\r\n  const [categories, setCategories] = useState([]); // Suponiendo que las categorías vienen del backend\r\n  const { auth, logout } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n    fetchCategories(); // Si las categorías se obtienen del backend\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      const response = await api.get('/data');\r\n      setData(response.data);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const fetchCategories = async () => {\r\n    try {\r\n      const response = await api.get('/categories'); // Ajusta según tu backend\r\n      setCategories(response.data);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (window.confirm('¿Estás seguro de eliminar este registro?')) {\r\n      try {\r\n        await api.delete(`/data/${id}`);\r\n        setData(data.filter((item) => item.id !== id));\r\n      } catch (err) {\r\n        console.error(err);\r\n        alert('Error al eliminar el registro.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleFilterChange = (e) => {\r\n    setFilters({ ...filters, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const applyFilters = () => {\r\n    // Implementar lógica para aplicar filtros. Podrías hacer una solicitud al backend con parámetros de consulta.\r\n    // Aquí se muestra una filtración en el frontend como ejemplo.\r\n\r\n    let filtered = [...data];\r\n\r\n    if (filters.keyword) {\r\n      filtered = filtered.filter((item) =>\r\n        item.name.toLowerCase().includes(filters.keyword.toLowerCase())\r\n      );\r\n    }\r\n\r\n    if (filters.startDate) {\r\n      filtered = filtered.filter((item) => new Date(item.date) >= new Date(filters.startDate));\r\n    }\r\n\r\n    if (filters.endDate) {\r\n      filtered = filtered.filter((item) => new Date(item.date) <= new Date(filters.endDate));\r\n    }\r\n\r\n    if (filters.category) {\r\n      filtered = filtered.filter((item) => item.category === filters.category);\r\n    }\r\n\r\n    return filtered;\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    logout();\r\n    window.location.href = '/';\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Listado</h2>\r\n      <button onClick={handleLogout}>Cerrar Sesión</button>\r\n      <div>\r\n        <h3>Filtros</h3>\r\n        <input\r\n          type=\"text\"\r\n          name=\"keyword\"\r\n          placeholder=\"Buscar por palabra clave\"\r\n          value={filters.keyword}\r\n          onChange={handleFilterChange}\r\n        />\r\n        <input\r\n          type=\"date\"\r\n          name=\"startDate\"\r\n          placeholder=\"Fecha de inicio\"\r\n          value={filters.startDate}\r\n          onChange={handleFilterChange}\r\n        />\r\n        <input\r\n          type=\"date\"\r\n          name=\"endDate\"\r\n          placeholder=\"Fecha de fin\"\r\n          value={filters.endDate}\r\n          onChange={handleFilterChange}\r\n        />\r\n        <select name=\"category\" value={filters.category} onChange={handleFilterChange}>\r\n          <option value=\"\">Todas las categorías</option>\r\n          {categories.map((cat) => (\r\n            <option key={cat.id} value={cat.name}>\r\n              {cat.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <button onClick={() => setFilters({ keyword: '', startDate: '', endDate: '', category: '' })}>\r\n          Limpiar Filtros\r\n        </button>\r\n      </div>\r\n      <Link to=\"/form\">Crear Nuevo Registro</Link>\r\n      <ul>\r\n        {applyFilters().map((item) => (\r\n          <li key={item.id}>\r\n            <strong>{item.name}</strong> - {item.email} - {item.category} - {item.date}\r\n            {auth.user.role === 'admin' && (\r\n              <>\r\n                <Link to={`/form/${item.id}`}>Editar</Link>\r\n                <button onClick={() => handleDelete(item.id)}>Eliminar</button>\r\n              </>\r\n            )}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ListPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}