{"ast":null,"code":"// src/pages/FormPage.js\nimport React,{useState,useEffect,useContext}from'react';import api from'../services/api';import{useNavigate,useParams}from'react-router-dom';import{AuthContext}from'../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function FormPage(){const[formData,setFormData]=useState({name:'',email:'',category:'',date:''});const[categories,setCategories]=useState([]);// Suponiendo que las categorías vienen del backend\nconst[error,setError]=useState(null);const navigate=useNavigate();const{id}=useParams();// Si hay un id, es una actualización\nconst{auth}=useContext(AuthContext);useEffect(()=>{fetchCategories();if(id){fetchData(id);}// eslint-disable-next-line\n},[id]);const fetchCategories=async()=>{try{const response=await api.get('/categories');// Ajusta según tu backend\nsetCategories(response.data);}catch(err){console.error(err);}};const fetchData=async id=>{try{const response=await api.get(`/data/${id}`);setFormData({name:response.data.name,email:response.data.email,category:response.data.category,date:response.data.date.split('T')[0]// Formatear fecha si es necesario\n});}catch(err){console.error(err);setError('Error al cargar el registro.');}};const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const validateForm=()=>{const{name,email,category,date}=formData;if(!name||!email||!category||!date){setError('Todos los campos son obligatorios.');return false;}// Validar formato de email\nconst emailRegex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;if(!emailRegex.test(email)){setError('Formato de email inválido.');return false;}// Validar fecha\nif(isNaN(new Date(date).getTime())){setError('Fecha inválida.');return false;}return true;};const handleSubmit=async e=>{e.preventDefault();setError(null);if(!validateForm())return;try{if(id){// Actualizar registro existente\nawait api.put(`/data/${id}`,formData);alert('Registro actualizado con éxito.');}else{// Crear nuevo registro\nawait api.post('/data',formData);alert('Registro creado con éxito.');}navigate('/list');}catch(err){var _err$response,_err$response$data;console.error(err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Error al guardar el registro. Inténtalo de nuevo.');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:id?'Actualizar Registro':'Crear Nuevo Registro'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",placeholder:\"Nombre\",value:formData.name,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",placeholder:\"Email\",value:formData.email,onChange:handleChange,required:true}),/*#__PURE__*/_jsxs(\"select\",{name:\"category\",value:formData.category,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona una categor\\xEDa\"}),categories.map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat.name,children:cat.name},cat.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"date\",placeholder:\"Fecha\",value:formData.date,onChange:handleChange,required:true}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:id?'Actualizar':'Guardar'})]})]});}export default FormPage;","map":{"version":3,"names":["React","useState","useEffect","useContext","api","useNavigate","useParams","AuthContext","jsx","_jsx","jsxs","_jsxs","FormPage","formData","setFormData","name","email","category","date","categories","setCategories","error","setError","navigate","id","auth","fetchCategories","fetchData","response","get","data","err","console","split","handleChange","e","target","value","validateForm","emailRegex","test","isNaN","Date","getTime","handleSubmit","preventDefault","put","alert","post","_err$response","_err$response$data","message","children","onSubmit","type","placeholder","onChange","required","map","cat","style","color"],"sources":["C:/Users/casti/OneDrive/Escritorio/frontend_GDocumetnal/src/pages/FormPage.js"],"sourcesContent":["// src/pages/FormPage.js\r\nimport React, { useState, useEffect, useContext } from 'react';\r\nimport api from '../services/api';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nfunction FormPage() {\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    email: '',\r\n    category: '',\r\n    date: '',\r\n  });\r\n  const [categories, setCategories] = useState([]); // Suponiendo que las categorías vienen del backend\r\n  const [error, setError] = useState(null);\r\n  const navigate = useNavigate();\r\n  const { id } = useParams(); // Si hay un id, es una actualización\r\n  const { auth } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    fetchCategories();\r\n    if (id) {\r\n      fetchData(id);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [id]);\r\n\r\n  const fetchCategories = async () => {\r\n    try {\r\n      const response = await api.get('/categories'); // Ajusta según tu backend\r\n      setCategories(response.data);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const fetchData = async (id) => {\r\n    try {\r\n      const response = await api.get(`/data/${id}`);\r\n      setFormData({\r\n        name: response.data.name,\r\n        email: response.data.email,\r\n        category: response.data.category,\r\n        date: response.data.date.split('T')[0], // Formatear fecha si es necesario\r\n      });\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError('Error al cargar el registro.');\r\n    }\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const validateForm = () => {\r\n    const { name, email, category, date } = formData;\r\n    if (!name || !email || !category || !date) {\r\n      setError('Todos los campos son obligatorios.');\r\n      return false;\r\n    }\r\n    // Validar formato de email\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(email)) {\r\n      setError('Formato de email inválido.');\r\n      return false;\r\n    }\r\n    // Validar fecha\r\n    if (isNaN(new Date(date).getTime())) {\r\n      setError('Fecha inválida.');\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    if (!validateForm()) return;\r\n\r\n    try {\r\n      if (id) {\r\n        // Actualizar registro existente\r\n        await api.put(`/data/${id}`, formData);\r\n        alert('Registro actualizado con éxito.');\r\n      } else {\r\n        // Crear nuevo registro\r\n        await api.post('/data', formData);\r\n        alert('Registro creado con éxito.');\r\n      }\r\n      navigate('/list');\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError(\r\n        err.response?.data?.message || 'Error al guardar el registro. Inténtalo de nuevo.'\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>{id ? 'Actualizar Registro' : 'Crear Nuevo Registro'}</h2>\r\n      <form onSubmit={handleSubmit}>\r\n        <input\r\n          type=\"text\"\r\n          name=\"name\"\r\n          placeholder=\"Nombre\"\r\n          value={formData.name}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n        <input\r\n          type=\"email\"\r\n          name=\"email\"\r\n          placeholder=\"Email\"\r\n          value={formData.email}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n        <select name=\"category\" value={formData.category} onChange={handleChange} required>\r\n          <option value=\"\">Selecciona una categoría</option>\r\n          {categories.map((cat) => (\r\n            <option key={cat.id} value={cat.name}>\r\n              {cat.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n        <input\r\n          type=\"date\"\r\n          name=\"date\"\r\n          placeholder=\"Fecha\"\r\n          value={formData.date}\r\n          onChange={handleChange}\r\n          required\r\n        />\r\n        {error && <p style={{ color: 'red' }}>{error}</p>}\r\n        <button type=\"submit\">{id ? 'Actualizar' : 'Guardar'}</button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FormPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}